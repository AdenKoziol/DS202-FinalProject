---
title: "Analysis of Real Estate in the U.S."
author: "Aden Koziol"
output: github_document
---

## Data
The dataset `realtor-data.csv` contains information about real estate listings, including variables such as price, number of bedrooms/bathrooms, square footage, location, and other relevant features.  

## Data Cleaning

```{r data-loading}
library(tidyverse)
library(knitr)

realtor_data <- read_csv("realtor-data.csv")

# Missing values
missing_values <- colSums(is.na(realtor_data))

# Remove rows with missing critical data (e.g., price, bedrooms)
cleaned_data <- realtor_data %>%
  drop_na(price, bed, bath, house_size)

# Remove duplicates
cleaned_data <- distinct(cleaned_data)

# Convert price to numeric (if stored as character)
cleaned_data <- cleaned_data %>%
  mutate(price = as.numeric(gsub("[\\$,]", "", price)))

# Filter out unrealistic prices (e.g., below $10,000 or above $10M)
cleaned_data <- cleaned_data %>%
  filter(price >= 10000 & price <= 10000000)
```

## Marginal Summaries
```{r}
# Summary statistics for numeric variables
summary_stats <- cleaned_data %>%
  select(price, bed, bath, house_size) %>%
  summary()

kable(summary_stats, caption = "Summary Statistics")

# Distribution of categorical variables (e.g., state, city)
if ("state" %in% colnames(cleaned_data)) {
  state_counts <- cleaned_data %>%
    count(state) %>%
    arrange(desc(n))
  
  kable(state_counts, caption = "Property Count by State")
}
```

## Questions To Be Addressed

### How does property price per square foot vary between states?

```{r}
# price per square foot
cleaned_data <- cleaned_data %>%
  mutate(price_per_sqft = price / house_size)

# plot
library(ggplot2)

cleaned_data %>%
  group_by(state) %>%
  summarise(avg_price_per_sqft = mean(price_per_sqft, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(state, -avg_price_per_sqft), y = avg_price_per_sqft)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(
    title = "Average Price per Square Foot by State",
    x = "State",
    y = "Price per Sqft ($)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

If we exclude territories, we can see that Hawaii, California, New York, and Massachusetts have a higher average price per square foot than the rest of the states while Ohio, West Virginia, Kansas, and Mississippi have a lower average price per square foot.


EXPLAIN/RESEARCH WHY THIS MAY BE

### How does price per square foot vary between urban, suburban, and rural properties?

```{r}
# classify urban, suburban, and rural cities
cleaned_data <- cleaned_data %>%
  mutate(
    location_type = case_when(
      city %in% c("Des Moines", "Cedar Rapids") ~ "Urban",
      city %in% c("North Liberty", "Coralville") ~ "Suburban",
      city %in% c("Elma", "Sac City") ~ "Rural",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(state == "Iowa" & !is.na(location_type)) 

# price per square foot
avg_price_sqft <- cleaned_data %>%
  group_by(location_type) %>%
  summarise(
    avg_price_per_sqft = mean(price_per_sqft, na.rm = TRUE),
    se = sd(price_per_sqft, na.rm = TRUE) / sqrt(n())
  )


# plot
library(ggplot2)

ggplot(avg_price_sqft, aes(x = location_type, y = avg_price_per_sqft, fill = location_type)) +
  geom_bar(stat = "identity") +
  geom_errorbar(
    aes(ymin = avg_price_per_sqft - se, ymax = avg_price_per_sqft + se),
    width = 0.2,
    color = "black"
  ) +
  scale_fill_manual(values = c("Urban" = "#E69F00", "Suburban" = "#56B4E9", "Rural" = "#009E73")) +
  labs(
    title = "Price per Square Foot in Iowa by Location Type",
    x = "Location Type",
    y = "Price per Sqft ($)",
    fill = "Location Type"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```


We can see that rural cities have a much lower average price per square foot than both urban and suburban cities. Suburban cities do have a slightly higher average price per square foot than urban cities.


EXPLAIN/RESEARCH WHY THIS MAY BE

### How does the number of bedrooms affect price?

```{r}
# Median price by bedrooms 1 - 6
bedroom_price <- cleaned_data %>%
  filter(bed %in% 1:6) %>%
  group_by(bed) %>%
  summarise(median_price = median(price, na.rm = TRUE))

# plot
ggplot(bedroom_price, aes(x = bed, y = median_price)) +
  geom_line(color = "#0072B2", linewidth = 1.5) +
  geom_point(size = 3, color = "#D55E00") +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = "Median Home Price by Number of Bedrooms",
    x = "Number of Bedrooms",
    y = "Median Price ($)"
  ) +
  theme_minimal()
```

### How does the number of bathrooms affect price?
```{r}
# median price of bathrooms 1-4
bathroom_price <- cleaned_data %>%
  mutate(bath_rounded = round(bath * 2) / 2) %>%  # Group as 1, 1.5, 2, etc.
  filter(bath_rounded %in% c(1, 1.5, 2, 2.5, 3, 3.5, 4)) %>%
  group_by(bath_rounded) %>%
  summarise(median_price = median(price, na.rm = TRUE))

# Line chart
ggplot(bathroom_price, aes(x = bath_rounded, y = median_price)) +
  geom_line(color = "#009E73", linewidth = 1.5) +
  geom_point(size = 3, color = "#CC79A7") +
  scale_y_continuous(labels = scales::dollar) +
  scale_x_continuous(breaks = seq(1, 4, by = 0.5)) +
  labs(
    title = "Median Home Price by Number of Bathrooms",
    x = "Number of Bathrooms",
    y = "Median Price ($)"
  ) +
  theme_minimal()
```